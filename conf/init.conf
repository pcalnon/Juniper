#!/usr/bin/env bash
#####################################################################################################################################################################################################
# Project:       Juniper
# Prototype:     Monitoring and Diagnostic Frontend for Cascade Correlation Neural Network
# File Name:     init.conf
# Author:        Paul Calnon
# Version:       0.1.4 (0.7.3)
#
# Date:          2025-11-10
# Last Modified: 2025-12-03
#
# License:       MIT License
# Copyright:     Copyright (c) 2024-2025 Paul Calnon
#
# Description:
#    This Script serves as the initialization config file for the Juniper Project's juniper_canopy prototype
#    Warning:  This Script / Config file is sourced by the try.bash script
#
#####################################################################################################################################################################################################
# Notes:
#     Warning:  This Config file is sourced by the try.bash script
#
#####################################################################################################################################################################################################
# References:
#
#####################################################################################################################################################################################################
# TODO :
#
#####################################################################################################################################################################################################
# COMPLETED:
#
#####################################################################################################################################################################################################


#####################################################################################################################################################################################################
# Define Top Level Constants for Script
#####################################################################################################################################################################################################
export TRUE="0"
export FALSE="1"

export DEBUG="${FALSE}"
# export DEBUG="${TRUE}"

SCRIPT_NAME="$(basename "$(realpath "${0}")")"
INPUT_SCRIPT_PATH_DEFAULT="$(dirname "$(dirname "$(realpath "${0}")")")/util/try.bash"


#####################################################################################################################################################################################################
# Define logging functions
#####################################################################################################################################################################################################
function log_debug() {
    [[ "${DEBUG}" == "${TRUE}" ]] && echo -ne "${SCRIPT_NAME}: ($(date +%F_%T)): [DEBUG] ${@}\n"
} && export -f log_debug

function log_info() {
    echo -ne "${SCRIPT_NAME}: ($(date +%F_%T)): [INFO] ${@}\n"
} && export -f log_info

function log_warning() {
    echo -ne "${SCRIPT_NAME}: ($(date +%F_%T)): [WARNING] ${@}\n"
} && export -f log_warning

function log_error() {
    echo -ne "${SCRIPT_NAME}: ($(date +%F_%T)): [ERROR] ${@}\n"
    set -e && exit 1
} && export -f log_error


#####################################################################################################################################################################################################
# Get Input Parameters
#####################################################################################################################################################################################################
export INPUT_SCRIPT_PATH="$( [[ "${1}" == "" ]] && echo "${INPUT_SCRIPT_PATH_DEFAULT}" || echo "${1}")" && log_debug "Input Script Path: ${INPUT_SCRIPT_PATH}"
export INPUT_SCRIPT_NAME="$(basename "${INPUT_SCRIPT_PATH}")" && log_debug "Input Script Name: ${INPUT_SCRIPT_NAME}"

#####################################################################################################################################################################################################
# Define Init Config File Constants
#####################################################################################################################################################################################################
log_debug "Script Name: ${SCRIPT_NAME}"

export PATH_DELIMITER="/" && log_debug "Path Delimiter: ${PATH_DELIMITER}"
export CONFIG_DIR_NAME="conf" && log_debug "Config Dir Name: ${CONFIG_DIR_NAME}"
export SOURCE_DIR_NAME="src" && log_debug "Source Dir Name: ${SOURCE_DIR_NAME}"
export PROTOTYPES_DIR_NAME="prototypes" && log_debug "Prototypes Dir Name: ${PROTOTYPES_DIR_NAME}"
export CONFIG_FILE_SUFFIX="conf" && log_debug "Config File Suffix: ${CONFIG_FILE_SUFFIX}"


#####################################################################################################################################################################################################
# Define Parsed Constants from Current Config File Path
#####################################################################################################################################################################################################
export ABS_SCRIPT_PATH="$(dirname "$(realpath "$0")")" && log_debug "Abs Script Path: ${ABS_SCRIPT_PATH}"
export PROTOTYPE_NAME="$(basename "${ABS_SCRIPT_PATH}")" && log_debug "Prototype Name: ${PROTOTYPE_NAME}"

export ABS_PROTOTYPES_DIR_PATH="$(dirname "${ABS_SCRIPT_PATH}")" && log_debug "Abs Prototypes Dir Path: ${ABS_PROTOTYPES_DIR_PATH}"
export PROTOTYPES_DIR_NAME="$(basename "${ABS_PROTOTYPES_DIR_PATH}")" && log_debug "Prototypes Dir Name: ${PROTOTYPES_DIR_NAME}"

export ABS_UTIL_PATH="$(dirname "${ABS_PROTOTYPES_DIR_PATH}")" && log_debug "Abs Util Path: ${ABS_UTIL_PATH}"
export UTIL_DIR_NAME="$(basename "${ABS_UTIL_PATH}")" && log_debug "Util Dir Name: ${UTIL_DIR_NAME}"


#####################################################################################################################################################################################################
# Define Project Directory Constants
#####################################################################################################################################################################################################
export ABS_PROJECT_PATH="$(dirname "${ABS_UTIL_PATH}")" && log_debug "Abs Project Path: ${ABS_PROJECT_PATH}"
export PROJECT_NAME="$(basename "${ABS_PROJECT_PATH}")" && log_debug "Project Name: ${PROJECT_NAME}"
export PROJECT_SOURCE_DIR_PATH="${ABS_PROJECT_PATH}${PATH_DELIMITER}${SOURCE_DIR_NAME}" && log_debug "Project Source Dir Path: ${PROJECT_SOURCE_DIR_PATH}"
export PROJECT_PROTOTYPES_DIR_PATH="${PROJECT_SOURCE_DIR_PATH}${PATH_DELIMITER}${PROTOTYPES_DIR_NAME}" && log_debug "Project Prototypes Dir Path: ${PROJECT_PROTOTYPES_DIR_PATH}"


#####################################################################################################################################################################################################
# Define Prototype Directory Constants
#####################################################################################################################################################################################################
export PROTOTYPE_DIR_PATH="${PROJECT_PROTOTYPES_DIR_PATH}${PATH_DELIMITER}${PROTOTYPE_NAME}" && log_debug "Prototype Dir Path: ${PROTOTYPE_DIR_PATH}"
export SOURCE_DIR_PATH="${PROTOTYPE_DIR_PATH}${PATH_DELIMITER}${SOURCE_DIR_NAME}" && log_debug "Source Dir Path: ${SOURCE_DIR_PATH}"
export CONFIG_DIR_PATH="${PROTOTYPE_DIR_PATH}${PATH_DELIMITER}${CONFIG_DIR_NAME}" && log_debug "Config Dir Path: ${CONFIG_DIR_PATH}"


#####################################################################################################################################################################################################
# Define Config File Name Constants
#####################################################################################################################################################################################################
export COMMON_CONFIG_FILE_NAME="common.${CONFIG_FILE_SUFFIX}" && log_debug "Common Config File Name: ${COMMON_CONFIG_FILE_NAME}"
export TEST_COMMON_CONFIG_FILE_NAME="test_common_${CONFIG_FILE_SUFFIX}.bash" && log_debug "Test Common Config File Name: ${TEST_COMMON_CONFIG_FILE_NAME}"

export COMMON_CONFIG_FILE="${CONFIG_DIR_PATH}${PATH_DELIMITER}${COMMON_CONFIG_FILE_NAME}" && log_debug "Common Config File: ${COMMON_CONFIG_FILE}"
export TEST_COMMON_CONFIG_FILE="${CONFIG_DIR_PATH}${PATH_DELIMITER}${TEST_COMMON_CONFIG_FILE_NAME}" && log_debug "Test Common Config File: ${TEST_COMMON_CONFIG_FILE}"

export PROTOTYPE_CONFIG_FILE_NAME="${PROTOTYPE_NAME}.${CONFIG_FILE_SUFFIX}" && log_debug "Prototype Config File Name: ${PROTOTYPE_CONFIG_FILE_NAME}"


#####################################################################################################################################################################################################
# Source the common config file
#####################################################################################################################################################################################################
log_debug "Common Config File Params: ${COMMON_CONFIG_FILE}, for Prototype Name: ${PROTOTYPE_NAME}, Project Name: ${PROJECT_NAME}, Prototype Config File Name: ${PROTOTYPE_CONFIG_FILE_NAME}"
if [[ "${DEBUG}" == "${FALSE}" ]]; then
    log_info "Sourcing Common Config File: ${COMMON_CONFIG_FILE} ${SCRIPT_NAME} ${PROTOTYPE_NAME} ${PROJECT_NAME} ${PROTOTYPE_CONFIG_FILE_NAME}"
    source "${COMMON_CONFIG_FILE}" "${SCRIPT_NAME}" "${PROTOTYPE_NAME}" "${PROJECT_NAME}" "${PROTOTYPE_CONFIG_FILE_NAME}"
else
    log_info "Calling the Test Common Config File Script: ${TEST_COMMON_CONFIG_FILE} ${SCRIPT_NAME} ${PROTOTYPE_NAME} ${PROJECT_NAME} ${PROTOTYPE_CONFIG_FILE_NAME}"
    "${TEST_COMMON_CONFIG_FILE}" "${SCRIPT_NAME}" "${PROTOTYPE_NAME}" "${PROJECT_NAME}" "${PROTOTYPE_CONFIG_FILE_NAME}"
fi
log_info "Completed Sourcing Common Config File: ${COMMON_CONFIG_FILE}, for Prototype Name: ${PROTOTYPE_NAME}, Project Name: ${PROJECT_NAME}, Prototype Config File Name: ${PROTOTYPE_CONFIG_FILE_NAME}"
